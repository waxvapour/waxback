var LandingPage={},unprovisionedWorkloadIds;LandingPage.provisioningCheckInterval=3e4,LandingPage.timer,LandingPage.requestInFlight=!1,LandingPage.GetUnprovisionedElementIds=function(){var n=[];return $(".workload_item.provisioning").each(function(t,i){n.push($(i).attr("id"))}),n},LandingPage.LogClick=function(n,t){try{if(t===!0&&$("#"+n).hasClass("provisioning"))return;var i=$("#aad").val();O365.Log.WriteLog(301233,O365.LogLevel.Info,O365.LogArea.GetStarted,O365.LogParameter.Empty,n,i)}catch(r){}},LandingPage.CheckProvisioningErrorCallback=function(n){O365.Log.WriteLog(300277,O365.LogLevel.Error,O365.LogArea.NotSpecified,n)},LandingPage.CheckProvisioningSuccessCallback=function(n){if(null!==n.statuses&&undefined!==n.statuses){for(var t in n.statuses)n.statuses.hasOwnProperty(t)&&($("#"+t+" a").attr("href",n.statuses[t]),$("#"+t).removeClass("provisioning"));LandingPage.GetUnprovisionedElementIds().length==0&&(clearInterval(LandingPage.timer),$("#ProvisioningHeader_Provisioning").hide(),$("#ProvisioningHeader_Completed").show())}},LandingPage.CheckProvisioningStatus=function(){var n=LandingPage.GetUnprovisionedElementIds();n.length!=0&&$.ajax({url:"Home/GetProvisioningStatus",cache:!1,data:{workloadTiles:n},traditional:!0,error:LandingPage.CheckProvisioningErrorCallback,success:LandingPage.CheckProvisioningSuccessCallback})},unprovisionedWorkloadIds=LandingPage.GetUnprovisionedElementIds(),unprovisionedWorkloadIds.length==0?$("#ProvisioningHeader_Completed").show():(LandingPage.timer=setInterval(LandingPage.CheckProvisioningStatus,LandingPage.provisioningCheckInterval),$("#ProvisioningHeader_Provisioning").show()),$(".PageLayout-Panels").css('min-height',$("#home_content").height()+100),$("#RootPageLayout a").each(function(n,t){$(t).click(function(){LandingPage.LogClick($(t).attr("id"),!0)})}),LandingPage.licenseAssignmentStatusCheckInterval=5e3,LandingPage.licenseAssignmentTimer,LandingPage.licenseAssignmentStatusCheckMaxAttempts=5,LandingPage.licenseAssignmentStatusCheckAttempts=0,LandingPage.IsLicenseAssignmentIncomplete=function(){return $("#licenseAssignmentInProgressDiv").css("display")=="block"},LandingPage.CheckLicenseAssignmentStatus=function(){clearInterval(LandingPage.licenseAssignmentTimer),LandingPage.licenseAssignmentStatusCheckAttempts++,$.ajax({url:"Home/AssignFirstUserLicensesIfRequired",data:{lastAttempt:LandingPage.licenseAssignmentStatusCheckAttempts==LandingPage.licenseAssignmentStatusCheckMaxAttempts},cache:!1,traditional:!0,error:LandingPage.CheckLicenseAssignmentErrorCallback,success:LandingPage.CheckLicenseAssignmentSuccessCallback})},LandingPage.CheckLicenseAssignmentErrorCallback=function(n){O365.Log.WriteLog(410878,O365.LogLevel.Error,O365.LogArea.NotSpecified,n),LandingPage.HandleLicenseAssignmentError()},LandingPage.CheckLicenseAssignmentSuccessCallback=function(n){n.isComplete===!0?null===n.target||undefined===n.target?location.reload(!0):Microsoft.Online.BOX.JS.Shared.VerifySafeUrl(n.target)&&(location.href=n.target):LandingPage.HandleLicenseAssignmentError()},LandingPage.HandleLicenseAssignmentError=function(){LandingPage.licenseAssignmentStatusCheckAttempts>=LandingPage.licenseAssignmentStatusCheckMaxAttempts?($("#licenseAssignmentInProgressDiv").hide(),$("#noLicenseDiv").show()):LandingPage.SetLicenseAssignmentTimer()},LandingPage.SetLicenseAssignmentTimer=function(){LandingPage.licenseAssignmentTimer=setInterval(LandingPage.CheckLicenseAssignmentStatus,LandingPage.licenseAssignmentStatusCheckInterval*(LandingPage.licenseAssignmentStatusCheckAttempts+1))},$(document).ready(function(){LandingPage.IsLicenseAssignmentIncomplete()&&LandingPage.SetLicenseAssignmentTimer()})